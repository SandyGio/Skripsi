%versi 2 (8-10-2016)
\chapter{Landasan Teori}
\label{chap:teori}

\section{\textit{Microsoft Graph API}}
\label{sec:microsoftgraph}
Microsoft Graph API adalah webservice yang berguna untuk mendapatkan data-data yang terdapat di dalam layanan Microsoft 365 yaitu seperti \textit{Azure Active Directory}, layanan \textit{Office} 365 (\textit{SharePoint, OneDrive, Outlook/Exchange, Microsoft Teams, OneNote, Planner,} dan \textit{Excel}), layanan \textit{Enterprise Mobility and Security} (\textit{Identity Manager, Intune, Advanced Threat Analytics,} dan \textit{Advanced Threat Protection}), layanan \textit{Windows} 10 (\textit{activities} dan \textit{devices}), dan \textit{Education}. Terdapat 2 versi referensi untuk \textit{Microsoft Graph API} yaitu versi 1.0 dan juga versi beta, tetapi yang dituliskan pada subbab ini mengacu kepada versi 1.0. Pada versi 1.0, \textit{endpoint} utama yang dipakai adalah mengacu kepada \textit{endpoint} \textit{https://graph.microsoft.com/v1.0}. Untuk menggunakan fungsi dari \textit{Microsoft Graph API}, dibutuhkan untuk mendaftarkan terlebih dahulu aplikasi yang akan dirancang dan memakai fungsi dari \textit{webservice} dari \textit{Microsoft Graph API} ke \textit{Microsoft App Registration Portal}\footnote{https://apps.dev.microsoft.com/}. Pada saat mendaftarkan aplikasinya, pastikan untuk menyalin dan menyimpan \textit{application ID} yang adalah pengenal unik untuk aplikasi yang didaftarkan, dan juga menyalin \textit{Redirect URL} yang didaftarkan sebagai \textit{URL} yang akan menerima balikan \textit{authentication} dan juga \textit{token} yang akan dikirim oleh \textit{endpoint Azure AD v2.0}, serta menyalin \textit{application secret} yang didapat saat mengklik ``\textit{Generate New Password}'' saat mendaftarkan aplikasi (berlaku jika mendaftarkan aplikasi berjenis \textit{web apps}). \textit{Application ID} yang didapat saat mendaftar aplikasi akan dipakai untuk mengisi nilai dari parameter \textit{client\_id} yang akan diisi saat akan melakukan \textit{request} untuk mendapatkan \textit{authorization\_code}. Setelah mendapatkan \textit{authorization\_code}, maka langkah selanjutnya adalah meminta \textit{access\_token} yang membutuhkan \textit{parameter} \textit{authorization\_code} kepada \textit{field code}, dan juga \textit{application\_secret} yang didapat dari pendaftaran aplikasi sebelumnya yang akan mengisi \textit{field client\_secret}. Response dari request token akan mengembalikkan jangka waktu aktif dari token tersebut dan juga refresh\_token yang akan berguna untuk meminta refresh\_token saat token sudah \textit{expired}.

Setelah mendapatkan access token, barulah layanan untuk mendapatkan data yang tersimpan di Microsoft baru bisa diakses dan didapatkan. Ada banyak layanan yang disediakan dari Microsoft Graph API 

\subsection{User resource type}
Kelas user ini merepresentasikan Azure AD user account. Kelas ini memiliki properti-properti dan juga method-method:
\textbf{Properti}
\begin{itemize}
	\item \textbf{aboutMe}
	Properti ini bertipe String yang merupakan field untuk mendeskripsikan diri pengguna. 
	\item \textbf{accountEnabled}
	Properti ini bertipe Boolean yang bernilai \textbf{true} jika akun diaktifkan dan akan bernilai \textbf{false} jika tidak. Properti ini berguna saat akan membuat akun. Nilai ini yang akan dipakai sebagai patokan sebuah akun bisa dibuat atau tidaknya. 
	\item \textbf{ageGroup}
	Properti ini bertipe String yang merupakan nilai kelompok umur dari pengguna. Terdapat nilai \textbf{null}, \textbf{minor}, \textbf{notAdult}, dan juga \textbf{adult}.
	\item \textbf{assignedLicenses}
	Properti ini bertipe koleksi assignedLicense yang merupakan nilai lisensi yang diberikan kepada pengguna.
	\item \textbf{assignedPlans}
	Properti ini bertipe koleksi assignedPlan yang merupakan nilai plan yang diberikan kepada pengguna.
	\item \textbf{birthday}
	Properti ini bertipe DateTimeOffset yang merupakan nilai ulang tahun dari pengguna. 
	\item \textbf{businessPhones}
	Properti ini bertipe String yang merupakan nomor telepon dari pengguna. Walaupun bersifat String, tetapi field ini hanya akan bisa diisi oleh angka.
	\item \textbf{city}
	Properti ini bertipe String yang merupakan kota lokasi pengguna.
	\item \textbf{companyName}
	Properti ini bertipe String yang merupakan nama perusahaan dimana pengguna terkait di dalamnya.
	\item \textbf{consentProvidedForMinor}
	Properti ini bertipe String yang merupakan status persetujuan bagi anak dibawah umur yang mengacu kepada properti ageGroup. Nilai dari properti ini bisa \textbf{null}, \textbf{granted}, \textbf{denied}, dan juga \textbf{notRequired}. 
	\item \textbf{country}
	Properti ini bertipe String yang merupakan negara lokasi pengguna.
	\item \textbf{createDateTime}
	Properti ini bertipe DateTimeOffset yang merupakan tanggal dibuatnya objek pengguna.
	\item \textbf{department}
	Properti ini bertipe String yang merupakan nama departemen pengguna bekerja.
	\item \textbf{displayName}
	Properti ini bertipe String yang merupakan nama yanng ditampilkan di buku alamat untuk pengguna. Biasanya disusun dari nama depan, nama tengah, dan juga nama belakang. Properti ini merupakan properti yang \textit{required} ketika pengguna dibuat dan tidak bisa dihapus. 
	 \item \textbf{employeeId}
	Properti ini bertipe String yang merupakan pengidentifikasi karyawan yang diberikan kepada pengguna oleh organisasi.
	\item \textbf{faxNumber}
	Properti ini bertipe String yang merupakan nomor fax pengguna.
	\item \textbf{givenName}
	Properti ini bertipe String yang merupakan nama depan dari pengguna.
	\item \textbf{hireDate}
	Properti ini bertipe DateTimeOffset yang merupakan tanggal pengguna dipekerjakan.
	\item \textbf{id}
	Properti ini bertipe String yang merupakan tanda pengenal unik untuk pengguna.
	\item \textbf{imAddresses}
	Properti ini bertipe koleksi String yang merupakan alamat protokol inisiasi sesi \textit{voice over IP} (VOIP) pesan untuk pengguna.
	\item \textbf{interests}
	Properti ini bertipe koleksi String yang merupakan kumpulan String yang mendeskripsikan ketertarikan dari pengguna.
	\item \textbf{isResourceAccount}
	Properti ini bertipe Boolean yang akan bernilai \textbf{true} jika akun merupakan \textit{resource account} dan akan bernilai \textbf{false} jika bukan. Jika kosong akan dianggap dengan nilai false.
	\item \textbf{jobTitle}
	Properti ini bertipe String yang merupakan jabatan dari pengguna.
	\item \textbf{legalAgeGroupClassification}
	Properti ini bertipe String yang merupakan tanda pengenal unik untuk pengguna.
\end{itemize}

\textbf{Method}
\begin{itemize}
	\item \textbf{List users}
	Method ini berfungsi untuk mendapatkan daftar dari objek pengguna. 
	\item \textbf{Create user}
	Method ini berfungsi untuk membuat pengguna. 
	\item \textbf{Get user}
	Method ini berfungsi untuk membaca properti dan juga hubungan pengguna. 
	\item \textbf{Update user}
	Method ini berfungsi untuk memperbaharui pengguna.
	\item \textbf{Delete user}
	Method ini berfungsi untuk menghapus pengguna.
	\item \textbf{List messages}
	Method ini berfungsi untuk mendapatkan semua pesan di kotak surat pengguna yang masuk.
	\item \textbf{Create message}
	Method ini berfungsi untuk membuat pesan baru untuk dimasukkan ke dalam koleksi pesan.
	\item \textbf{List mailFolders}
	Method ini berfungsi untuk mendapatkan folder-folder surat dibawah folder root dari pengguna yang masuk.
	\item \textbf{Create mailFolder}
	Method ini berfungsi untuk membuat mailFolder ke dalam koleksi mailFolders.
	\item \textbf{sendMail}
	Method ini berfungsi untuk mengirim pesan.
	\item \textbf{List events}
	Method ini berfungsi untuk mendapatkan daftar objek event di dalam kotak pesan dari pengguna.
	\item \textbf{Create event}
	Method ini berfungsi untuk membuat event ke dalam koleksi dari event-event.
	\item \textbf{List calendars}
	Method ini berfungsi untuk mendapatkan daftar objek calendar.
	\item \textbf{Create calendar}
	Method ini berfungsi untuk membuat objek calendar baru yang akan dikirim ke dalam koleksi objek calendars.
	\item \textbf{List calendarGroups}
	Method ini berfungsi untuk mendapatkan daftar objek calendarGroup.
	\item \textbf{Create calendarGroup}
	Method ini berfungsi untuk membuat objek calendarGroup baru kedalam koleksi calendarGroup.
	\item \textbf{List calendarView}
	Method ini berfungsi untuk mendapatkan koleksi objek event.
	\item \textbf{List contacs}
	Method ini berfungsi untuk mendapatkan daftar kontak dari folder Contacts pengguna yang masuk.
	\item \textbf{Create contact}
	Method ini berfungsi untuk membuat kontak baru untuk dimasukkan ke dalam koleksi kontak.
	\item \textbf{List contactFolders}
	Method ini berfungsi untuk mendapatkan koleksi folder kontak dari pengguna yang masuk.
	\item \textbf{Create contactFolder}
	Method ini berfungsi untuk membuat folder kontak.
	\item \textbf{List directReports}
	Method ini berfungsi untuk mendapatkan pengguna dan kontak yang melaporkan pengguna dari properti directReports.
	\item \textbf{List manager}
	Method ini berfungsi untuk mendapatkan manager pengguna dari properti manager.
	\item \textbf{List memberOf}
	Method ini berfungsi untuk mendapatkan kelompok dan peran dari anggota langsung pengguna lewat properti memberOf.
	\item \textbf{List transitive memberOf}
	Method ini berfungsi untuk mendapatkan kelompok dan peran dari pengguna lewat properti memberOf, tetapi method ini bersifat transitif dan mencakup grup-grup dimana pengguna menjadi anggota.
	\item \textbf{List ownedDevices}
	Method ini berfungsi untuk mendapatkan perangkat yang dimiliki oleh pengguna dari properti ownedDevices.
	\item \textbf{List ownedObjects}
	Method ini berfungsi untuk mendapatkan objek yang dimiliki pengguna yang didapat dari properti ownedObjects.
	\item \textbf{List registeredDevices}
	Method ini berfungsi untuk mendapatkan perangkat yang terregistrasi oleh pengguna dari properti registeredDevices.
	\item \textbf{List createdObjects}
	Method ini berfungsi untuk mendapatkan objek yang dibuat oleh pengguna dari properti createdObjects.
	\item \textbf{assignLicense}
	Method ini berfungsi untuk menambah atau membuang ``subscriptions'' dari pengguna, serta bisa untuk mengaktifkan dan menonaktifkan paket spesifik terkait dengan langganan.
	\item \textbf{List licenseDetails}
	Method ini berfungsi untuk mendapatkan koleksi objek licenseDetails.
	\item \textbf{checkMemberGroups}
	Method ini berfungsi untuk memeriksa keanggotaan dalam daftar grup.
	\item \textbf{getMemberGroups}
	Method ini mengembalikkan semua grup dimana pengguna menjadi anggota didalamnya.
	\item \textbf{getMemberObjects}
	Method ini mengembalikkan semua grup dan peran dimana pengguna menjadi anggota didalamnya.
	\item \textbf{reminderView}
	Method ini mengembalikkan daftar pengingat di kalender dengan jam mulai dan berakhirnya secara spesifik.
	\item \textbf{delta}
	Method ini berfungsi untuk mendapatkan perubahan tambahan pengguna.
\end{itemize}

\section{\textit{Outlook Calendar API}}
\label{sec:outlookcalendar}
Untuk mengakses dan mendapatkan data yang terdapat di \textit{Outlook.com Calendar}, dibutuhkan \textit{Microsoft Graph API}. \textit{Microsoft Graph} itu sendiri adalah gerbang untuk mendapatkan data-data yang terdapat di \textit{Microsoft} 365 dan \textit{Outlook.com Calendar} termasuk di dalam layanan \textit{Office} 365. \textit{Microsoft Graph API} adalah sebuah \textit{webservice} yang memiliki satu buah \textit{endpoint} untuk memperoleh data yang ada pada \textit{Azure Active Directory}, layanan \textit{Office} 365(\textit{SharePoint, OneDrive, Outlook/Exchange, Microsoft Teams, OneNote, Planner,} dan \textit{Excel}), layanan \textit{Enterprise Mobility and Security}(\textit{Identity Manager, Intune, Advanced Threat Analytics,} dan \textit{Advanced Threat Protection}), layanan \textit{Windows} 10(\textit{activities} dan \textit{devices}), dan \textit{Education }yaitu menuju \textit{endpoint} ke \textit{https://graph.microsoft.com}. \textit{Microsoft Graph} dapat dipergunakan untuk membangun suatu aplikasi dengan memanfaatkan konteks unik dari masing-masing penggunanya. Aplikasi yang dapat dibangun dengan bantuan dari \textit{Microsoft Graph} bisa jadi memiliki fungsi seperti:

\begin{itemize}
\item Melihat pertemuan/ \textit{meeting} pengguna yang berikutnya sudah terjadwalkan serta membantu pengguna untuk mempersiapkan dengan memberikan informasi dari profil peserta. 
\item Melihat kepada kalender pengguna sehingga bisa merekomendasikan waktu yang tepat untuk pertemuan/ \textit{meeting} selanjutnya. 
\item Mengubah file \textit{Excel} yang berada di \textit{OneDrive} pengguna secara \textit{real-time} dan bisa melalui ponsel pengguna.
\item Memantau perubahan yang ada di kalender pengguna sehingga bisa memngirimkan peringatan jika pengguna menghabiskan terlalu banyak waktu untuk melakukan rapat, serta bisa juga merekomendasikan \textit{event-event} yang bisa didelegasikan atau dilewatkan berdasarkan dari seberapa relevannya \textit{event} itu kepada pengguna.
\item Membantu pengguna untuk bisa memilah informasi yang ditujukan untuk pekerjaan dengan informasi yang bersifat pribadi. Misalkan dengan pengelompokkan gambar-gambar pribadi yang masuk ke \textit{OneDrive} pribadi serta memasukkan gambar-gambar pekerjaan ke \textit{OneDrive for Business} pengguna.     
\end{itemize} 

Permintaan yang populer diminta pada \textit{Microsoft Graph API} antara lain: 
\begin{center}
\begin{tabular}{|p{2cm}|p{15cm}|}
 \hline \textbf{Operation} & \textbf{URL} \\ \hline 
 GET\newline my profile & https://graph.microsoft.com/v1.0/me \\ \hline
 GET\newline my files & https://graph.microsoft.com/v1.0/me/drive/root/children \\ \hline 
 GET\newline my photo & https://graph.microsoft.com/v1.0/me/photo/\$value \\ \hline
 GET\newline my mail & https://graph.microsoft.com/v1.0/me/messages \\ \hline 
 GET\newline my high importance email & https://graph.microsoft.com/v1.0/me/messages?\$filter=importance\%20eq\%20'high' \\ \hline 
 GET\newline my calendar events & https://graph.microsoft.com/v1.0/me/events \\ \hline 
 GET\newline my manager & https://graph.microsoft.com/v1.0/me/manager \\ \hline 
 GET\newline last user to modify file foo.txt & https://graph.microsoft.com/v1.0/me/drive/root/children/foo.txt/lastModifiedByUser \\ \hline 
 GET\newline Office365 groups I'm member of & https://graph.microsoft.com/v1.0/me/memberOf/\$/microsoft.graph.group?\$filter=\newline groupTypes/any(a:a\%20eq\%20'unified') \\ \hline 
 GET\newline users in my organization & https://graph.microsoft.com/v1.0/users \\ \hline 
 GET\newline groups in my organization & https://graph.microsoft.com/v1.0/groups \\ \hline 
 GET\newline people related to me & https://graph.microsoft.com/v1.0/me/people \\ \hline
 GET\newline items trending around me & https://graph.microsoft.com/beta/me/insights/trending \\ \hline
 GET\newline my notes & https://graph.microsoft.com/v1.0/me/onenote/notebooks \\ \hline
\end{tabular}
\end{center}

Dari \textit{Microsoft Graph} ini, barulah dapat mengakses \textit{Outlook.com Calendar API}. Cara untuk menggunakan membangun aplikasi menggunakan \textit{API} dari \textit{Microsoft} yang tersedia adalah:
\begin{description}
\item [Mendaftarkan aplikasi yang akan dibuat ke Azure AD.]\hfill \\ Untuk Mendaftarkan aplikasi yang akan dibuat, ada beberapa langkah yaitu:

\begin{enumerate}
	\item Masuk ke \textit{Microsoft App Registration Portal} dengan menggunakan akun \textit{Microsoft} atau akun sekolah atau akun kantor. 
	\item Pilih dan klik tombol bertuliskan ``\textit{Add an app}''.
	\item Masukkan nama untuk aplikasi yang akan dibuat dan klik tombol ``\textit{Create application}''.
	\item Salin ``\textit{application ID}''. \textit{Application ID} ini nantinya dipergunakan untuk mengkonfigurasikan aplikasinya. 
	\item Dibawah bagian ``\textit{Platforms}'', pilih tombol ``\textit{Add Platforms}'' dan pilihlah \textit{platform} yang sesuai untuk aplikasi. 
	
		\subitem \textbf{Untuk \textit{Native} atau \textit{Mobile apps}:}
		\begin{enumerate}
		\item Pilih ``\textit{Native Application}''.
		\item Salin bagian ``\textit{Built-in redirect URI}''. Hal ini diperlukan untuk menkonfigurasi aplikasinya. \textit{Redirect URI} ini disediakan identik untuk aplikasinya yang gunanya untuk memastikan bahwa pesan yang dikirim ke \textit{URI} hanya dikirim ke aplikasi itu. 
		\end{enumerate}	
		
		\subitem \textbf{Untuk \textit{web apps}}
		\begin{enumerate}
		\item Pilih ``\textit{Web}''.
		\item \textit{Check} kotak dengan tulisan ``\textit{Allow Implicit Flow}'' jika ingin mengaktifkan \textit{OpenID Connect Hybrid} dan \textit{implicit flow}. \textit{Implicit Flow} memungkinkan aplikasi untuk menerima \textit{sign-in info} dan juga \textit{access token}, sedangkan nilai \textit{default} dari bagian ini adalah \textit{hybrid flow} dimana \textit{flow} ini memungkinkan aplikasi untuk menerima \textit{sign-in info} yaitu \textit{token id}, dan juga \textit{artifacts} atau dalam kasus ini adalah kode otorisasi yang digunakan aplikasi untuk mendapatkan \textit{access token}.
		\item Tentukan \textit{redirect URI} yang adalah bagian dari aplikasi yang dihubungi oleh \textit{endpoint} dari \textit{Azure AD} 2.0 saat memproses permintaan otentikasi. 
		\item Dibawah ``\textit{Application Secrets}'', pilihlah ``\textit{Generate New Password}'' dan salinlah \textit{app secret} yang terdapat di \textit{New Password generated dialog box}. Perlu diketahui bahwa salinlah \textit{app secret} sebelum \textit{New password generated dialog} ditutup karena setelah ditutup, \textit{app secret} tidak dapat diambil lagi. 
		\end{enumerate}
	\item Pilihlah ``\textit{Save}''.			 
	\end{enumerate}
	
Tabel berikut menunjukkan \textit{properties} yang perlu dikonfigurasi dan disalin untuk berbagai jenis aplikasi. Nilai \textit{assigned.} berarti harus menggunakan nilai yang diberikan oleh \textit{Azure AD}. 

\item [Mendapatkan otorisasi.]\hfill \\Langkah pertama untuk mendapatkan otorisasi adalah dengan cara meminta kepada \textit{Azure AD} 2.0 \textbf{/authorize} \textit{endpoint}. Azure ID akan mengecek pengguna yang masuk dan memastikan persetujuan pengguna untuk izin permintaan aplikasi tersebut. Berikut contoh \textit{request} untuk mendapatkan \textit{authorize code}:

\begin{center}
	\begin{tabular}{|p{15cm}|}
	\hline
	https://login.microsoftonline.com/\{tenant\}/oauth2/v2.0/authorize?\newline
	client\_id=6731de76-14a6-49ae-97bc-6eba6914391e\newline
	\&response\_type=code\newline
	\&redirect\_uri=http\%3A\%2F\%2Flocalhost\%2Fmyapp\%2F\newline
	\&response\_mode=query\newline
	\&scope=offline\_access\%20user.read\%20mail.read\newline
	\&state=12345\\
	\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{|p{2.5cm}|p{2.5cm}|p{10cm}|}
		\hline
		\textbf{Parameter}& &\textbf{Deskripsi}\\ \hline
		\textit{tenant} & \textit{required} & Nilai yang dipakai untuk mengontrol siapa yang bisa mengakses masuk ke aplikasi. Nilainya bisa diisi dengan akun \textit{Microsoft}. \\ \hline
		 \textit{client\_id} & \textit{required} & Diisi dengan \textit{Application ID} yang diberikan oleh portal registrasi (\textit{apps.dev.microsoft.com}).\\ \hline
		 \textit{response\_type} & \textit{required} & Diisi dengan nilai ``\textit{code}'' untuk menjalankan kode otorisasi.\\ \hline
		 \textit{redirect\_uri} & \textit{recommended} & Diisi dengan redirect uri yang nantinya akan menerima respon dari otentikasi yang akan diterima oleh aplikasi. Nilai disini harus sama dengan yang sudah diisi di portal registrasi kecuali \textit{URL} yang disandikan. Untuk \textit{native} dan \textit{mobile apps}, ada nilai default untuk \textit{redirect uri} yaitu menuju ke \textit{https://login.microsoftonline.com/common/oauth2/nativeclient}.\\ \hline
		 \textit{scope} & \textit{required} & Diisi dengan hak akses pada \textit{Microsoft Graph} yang akan diberikan pada pengguna aplikasi. \\ \hline
		 \textit{response\_mode} & \textit{recommended} & Nilai yang akan menentukan metode kembalian \textit{token} yang akan dihasilkan kembali ke aplikasi. Terdapat 2 nilai yaitu ``\textit{query}'' dan ``\textit{form\_post}''. \\ \hline
		 \textit{state} & \textit{recommended} & Nilai yang dipasang untuk mencegah serangan \textit{cross-site request}. Parameter ini juga bisa digunakan untuk menyandikan informasi tentang keadaan pengguna di aplikasi sebelum melakukan permintaan otentikasi.\\
		 \hline		 
	\end{tabular}
\end{center}

Setelah melakukan request untuk mendapatkan kode otentikasi, maka akan ditujukan ke halaman yang seperti ini. 

Bentuk dari respon otentikasi seperti:

\begin{center}
	\begin{tabular}{|p{15cm}|}
		\hline
		GET https://localhost/myapp/?\newline
		code=M0ab92efe-b6fd-f08-87dc-2c6500a7f84d\newline
		\&state=12345\\ \hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{|p{3cm}|p{12cm}|}
		\hline
		\textbf{Parameter}&\textbf{Deskripsi}\\ \hline
		\textit{code} & Kode otorisasi yang diminta aplikasi. Dengan kode otorisasi ini, aplikasi bisa meminta \textit{access token} untuk mendapatkan data. Kode otorisasi memiliki umur yang singkat yaitu akan \textit{expired} setelah 10 menit. \\ \hline
		 \textit{state} & Nilai yang akan bernilai sama persis seperti saat melakukan \textit{request} jika saat melakukan \textit{request} memasukkan parameter ``\textit{state}'' juga.\\
		 \hline		 
	\end{tabular}
\end{center}

Setelah mendapat \textit{authorize code}, maka otorisasi dilanjutkan dengan meminta kepada \textit{Azure AD} 2.0 \textbf{/token} \textit{endpoint} untuk mendapatkan \textit{access token} untuk aplikasi tersebut. Aplikasi yang ingin melakukan \textit{request} untuk mendapatkan \textit{access token} akan memakai kode otorisasi dan juga mengirimkan \textit{request} dengan cara ``\textit{post}''. Berikut contoh format untuk melakukan \textit{request} kepada \textit{endpoint} \textit{/token}.

\begin{center}
	\begin{tabular}{|p{15cm}|}
		\hline
		POST /common/oauth2/v2.0/token HTTP/1.1\newline
		Host: https://login.microsoftonline.com\newline
		Content-Type: application/x-www-form-urlencoded\newline
		\newline
		client\_id=6731de76-14a6-49ae-97bc-6eba6914391e\newline
		\&scope=user.read\%20mail.read\newline
		\&code=OAAABAAAAiL9Kn2Z27UubvWFPbm0gLWQJVzCTE9UkP3pSx1aXxUjq3n8b2\newline
		JRLk4OxVXr...\newline
		\&redirect\_uri=http\%3A\%2F\%2Flocalhost\%2Fmyapp\%2F\newline
		\&grant\_type=authorization\_code\newline
		\&client\_secret=JqQX2PNo9bpM0uEihUPzyrh    // NOTE: Only required for web apps\\
		\hline
	\end{tabular}
\end{center} 

\begin{center}
	\begin{tabular}{|p{3cm}|p{2cm}|p{10cm}|}
		\hline
		\textbf{Parameter}& &\textbf{Deskripsi}\\ \hline
		\textit{tenant} & \textit{required} & Nilai yang dipakai untuk mengontrol siapa yang bisa mengakses masuk ke aplikasi. Nilainya bisa diisi dengan akun \textit{Microsoft}. \\ \hline
		 \textit{client\_id} & \textit{required} & Diisi dengan \textit{Application ID} yang diberikan oleh portal registrasi (\textit{apps.dev.microsoft.com}).\\ \hline
		 \textit{grant\_type} & \textit{required} & Diisi dengan nilai ``\textit{authorization\_code}'' untuk menjalankan kode otorisasi.\\ \hline
		 \textit{scope} & \textit{required} & Diisi dengan hak akses pada \textit{Microsoft Graph} yang akan diberikan pada pengguna aplikasi. \\ \hline
		 \textit{code} & \textit{required} & Kode otorisasi yang didapat saat melakukan request pertama.\\ \hline 
		 \textit{redirect\_uri} & \textit{required} & \textit{redirect\_uri} yang sama yang digunakan untuk mendapatkan kode otorisasi. \\ \hline
		 \textit{client\_secret} & \textit{required for web apps} & \textit{App secret} yang didapat saat membuat dan mendaftarkan aplikasi di portal registrasi. \textit{Client\_secret} ini hanya berlaku untuk \textit{web apps} dan juga \textit{web APIs} karena di \textit{native app} tidak memungkinkan untuk menyimpan \textit{client\_secret} di gawai masing-masing. \\ \hline
	\end{tabular}
\end{center}

Contoh respon jika request berhasil diproses adalah seperti berikut:
\begin{center}
	\begin{tabular}{|p{15cm}|}
		\hline
		\{\newline
    	"token\_type": "Bearer",\newline
    	"scope": "user.read\%20Fmail.read",\newline
    	"expires\_in": 3600,\newline
    	"access\_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0\newline
    	aEV1Q...",\newline
    	"refresh\_token": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGAMxZGUTdM0t4B4..."\newline
		\}\\ \hline
	\end{tabular}
\end{center} 

Setelah mendapatkan \textit{access token}, barulah akses untuk mendapatkan data-data dari \textit{Outlook.com Calendar} bisa diakses dengan menggunakan \textit{Outlook.com Calendar API}. Pentingnya langkah sebelum ini dikarenakan untuk melakukan \textit{request} kepada \textit{Outlook.com Calendar API} diperlukan parameter \textit{access token} saat hendak melakukan \textit{request}. Adapun list dari \textit{request} yang akan dipakai dari \textit{Outlook.com Calendar API} adalah:

\begin{center}
	\begin{tabular}{|p{5cm}|p{10cm}|}
	\hline
		Request & endpoint\\ \hline 
		List events & GET /me/events\\
		 & GET /users/\{id | userPrincipalName\}/events \\
		 & GET /me/calendar/events\\
		 & GET /users/\{id | userPrincipalName\}/calendar/events\\
		 & GET /me/calendars/\{id\}/events\\
		 & GET /users/\{id | userPrincipalName\}/calendars/\{id\}/events\\
		 & GET /me/calendargroup/calendars/\{id\}/events\\
		 & GET /users/\{id | userPrincipalName\}/calendargroup/calendars/\{id\}/events\\
		 & GET /me/calendargroups/\{id\}/calendars/\{id\}/events\\
		 & GET /users/\{id | userPrincipalName\}/calendargroups/\{id\}/calendars/\{id\}/events\\
	\hline
	\end{tabular}
\end{center} 

Request di atas akan meminta event yang ada di akun pengguna. Field \{id\} di atas diisi oleh id dari pengguna. Sedangkan field \{userPrincipalName\} bisa diisi dengan nama pengguna. 

\begin{lstlisting}[caption={Contoh respon dari request List events diatas},label={lst:atribute-view},language=xml]

HTTP/1.1 200 OK
Content-type: application/json
Preference-Applied: outlook.timezone="Pacific Standard Time"
Content-length: 1932

{
    "@odata.context":"https://graph.microsoft.com/v1.0/$metadata#
    users('cd209b0b-3f83-4c35-82d2-d88a61820480')/events(subject,body,bodyPreview,organizer,attendees,start,end,location)",
    "value":[
        {
            "@odata.etag":"W/\"ZlnW4RIAV06KYYwlrfNZvQAAKGWwbw==\"",
            "id":"AAMkAGIAAAoZDOFAAA=",
            "subject":"Orientation ",
            "bodyPreview":"Dana, this is the time you selected for our 
            orientation. Please bring the notes I sent you.",
            "body":{
                "contentType":"html",
                "content":"<html><head></head><body><p>Dana, this is the 
                time you selected for our orientation. Please bring the 
                notes I sent you.</p></body></html>"
            },
            "start":{
                "dateTime":"2017-04-21T10:00:00.0000000",
                "timeZone":"Pacific Standard Time"
            },
            "end":{
                "dateTime":"2017-04-21T12:00:00.0000000",
                "timeZone":"Pacific Standard Time"
            },
            "location": {
                "displayName": "Assembly Hall",
                "locationType": "default",
                "uniqueId": "Assembly Hall",
                "uniqueIdType": "private"
            },
            "locations": [
                {
                    "displayName": "Assembly Hall",
                    "locationType": "default",
                    "uniqueIdType": "unknown"
                }
            ],
            "attendees":[
                {
                    "type":"required",
                    "status":{
                        "response":"none",
                        "time":"0001-01-01T00:00:00Z"
                    },
                    "emailAddress":{
                        "name":"Samantha Booth",
                        "address":"samanthab@a830edad905084922E17020313.
                        onmicrosoft.com"
                    }
                },
                {
                    "type":"required",
                    "status":{
                        "response":"none",
                        "time":"0001-01-01T00:00:00Z"
                    },
                    "emailAddress":{
                        "name":"Dana Swope",
                        "address":"danas@a830edad905084922E17020313.
                        onmicrosoft.com"
                    }
                }
            ],
            "organizer":{
                "emailAddress":{
                    "name":"Samantha Booth",
                    "address":"samanthab@a830edad905084922E17020313.
                    onmicrosoft.com"
                }
            }
        }
    ]
}
\end{lstlisting} 
	
\end{description}


\section{\textit{Slack API}}
\label{sec:slack}
Slack API adalah webservice yang akan digunakan untuk menghubungkan data yang sudah di dapat dari Outlook.com Calendar ke aplikasi Slack. Disini akan dipakai API yang berfungsi untuk mengubah status dari pengguna Slack. 


\section{\textit{Node.js}}
\label{sec:nodejs}


\section{Cron}
\label{sec:cron}
 
